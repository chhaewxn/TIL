## ğŸ“ 7ì¥ ê³ ê¸‰ ë§¤í•‘

### ìƒì† ê´€ê³„ ë§¤í•‘
ORMì—ì„œ ì´ì•¼ê¸°í•˜ëŠ” ìƒì† ê´€ê³„ ë§¤í•‘ì€ ê°ì²´ì˜ ìƒì† êµ¬ì¡°ì™€ ë°ì´í„°ë² ì´ìŠ¤ì˜ ìŠˆí¼íƒ€ì… ì„œë¸Œíƒ€ì… ê´€ê³„ë¥¼ ë§¤í•‘í•˜ëŠ” ê²ƒ!

#### ìŠˆí¼íƒ€ì…, ì„œë¸Œíƒ€ì… ë…¼ë¦¬ ëª¨ë¸ì„ ë¬¼ë¦¬ ëª¨ë¸ êµ¬í˜„í•˜ëŠ” 3ê°€ì§€ ë°©ë²•
- ê°ê°ì˜ í…Œì´ë¸”ë¡œ ë³€í™˜ : ìŠˆí¼íƒ€ì…, ì„œë¸Œíƒ€ì… í…Œì´ë¸”ì„ ê°ê° ìƒì„±í•˜ì—¬ ì¡°íšŒí•  ë•Œ ì¡°ì¸ì„ ì‚¬ìš©í•œë‹¤.
- í†µí•© í…Œì´ë¸”ë¡œ ë³€í™˜ : í…Œì´ë¸”ì„ í•˜ë‚˜ë§Œ ì‚¬ìš©í•´ì„œ í†µí•©í•œë‹¤. JPAì—ì„œëŠ” ë‹¨ì¼ í…Œì´ë¸” ì „ëµ
- ì„œë¸Œíƒ€ì… í…Œì´ë¸”ë¡œ ë³€í™˜ : ì„œë¸Œ íƒ€ì…ë§ˆë‹¤ í•˜ë‚˜ì˜ í…Œì´ë¸”ì„ ë§Œë“ ë‹¤. JPAì—ì„œëŠ” êµ¬í˜„ í´ë˜ìŠ¤ í…Œì´ë¸” ì „ëµ

#### ì¡°ì¸ ì „ëµ
ìì‹ í…Œì´ë¸”ì´ ë¶€ëª¨ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ë¥¼ ë°›ì•„ì„œ ê¸°ë³¸ í‚¤ + ì™¸ë˜ í‚¤ë¡œ ì‚¬ìš©í•˜ëŠ” ì „ëµ

**ğŸš¨ ì£¼ì˜í•  ì **
íƒ€ì…ì„ êµ¬ë¶„í•˜ëŠ” ì»¬ëŸ¼ì„ ì¶”ê°€í•´ì•¼ í•œë‹¤. ì—¬ê¸°ì„œëŠ” DTYPE ì»¬ëŸ¼ì„ êµ¬ë¶„ ì»¬ëŸ¼ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.
```java
@Entity
@Inheritance(strategy = InheritanceType.JOINED) // ìƒì† ë§¤í•‘ì€ ë¶€ëª¨ í´ë˜ìŠ¤ì— ì„ ì–¸í•´ì•¼ í•œë‹¤. 
@DiscriminatorColumn(name = "DTYPE") // ë¶€ëª¨ í´ë˜ìŠ¤ì— êµ¬ë¶„ ì»¬ëŸ¼ì„ ì§€ì •í•œë‹¤. 
public abstract class Item {

	@Id @GeneratedValue
	@Column(name = "ITEM_ID")
	private Long id;

	private String name; //ì´ë¦„
	private int price; //ê°€ê²©
	...
}

@Entity
@DiscriminatorValue("A") // ì—”í‹°í‹°ë¥¼ ì €ì¥í•  ë•Œ êµ¬ë¶„ ì»¬ëŸ¼ì— ì…ë ¥í•  ê°’ì„ ì§€ì •í•œë‹¤. 
public class Album extends Item {
  private String artist;
	...
}

@Entity
@DiscriminatorValue("M")
@PrimaryKeyJoinColumn(name = "MOVIE_ID") // ìì‹ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ ì»¬ëŸ¼ëª…ì„ ë³€ê²½ (ê¸°ë³¸ ê°’ì€ ë¶€ëª¨ í…Œì´ë¸”ì˜ ID ì»¬ëŸ¼ëª…)
public class Movie extends Item {
  private String director; //ê°ë…
  private String actor; //ë°°ìš°
	...
}
```

ğŸ”» ì¥ì 
- í…Œì´ë¸”ì´ ì •ê·œí™”ëœë‹¤.
- ì™¸ë˜ í‚¤ ì°¸ì¡° ë¬´ê²°ì„± ì œì•½ ì¡°ê±´ì„ í™œìš©í•  ìˆ˜ ìˆë‹¤.
- ì €ì¥ê³µê°„ì„ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.

ğŸ”» ë‹¨ì 
- ì¡°íšŒí•  ë•Œ ì¡°ì¸ì´ ë§ì´ ì‚¬ìš©ë˜ë¯€ë¡œ ì„±ëŠ¥ì´ ì €í•˜ë  ìˆ˜ ìˆë‹¤.
- ì¡°íšŒ ì¿¼ë¦¬ê°€ ë³µì¡í•˜ë‹¤
- ë°ì´í„°ë¥¼ ë“±ë¡í•  INSERT SQLì„ ë‘ ë²ˆ ì‹¤í–‰í•œë‹¤.

ğŸ”»íŠ¹ì§•
JPA í‘œì¤€ ëª…ì„¸ëŠ” êµ¬ë¶„ ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ë„ë¡ í•˜ì§€ë§Œ í•˜ì´ë²„ë„¤ì´íŠ¸ë¥¼ í¬í•¨í•œ ëª‡ëª‡ êµ¬í˜„ì²´ëŠ” êµ¬ë¶„ ì»¬ëŸ¼(@DiscriminatorColumn) ì—†ì´ë„ ë™ì‘í•œë‹¤.

#### ë‹¨ì¼ í…Œì´ë¸” ì „ëµ
ì´ë¦„ ê·¸ëŒ€ë¡œ í…Œì´ë¸”ì„ í•˜ë‚˜ë§Œ ì‚¬ìš©í•œë‹¤. ê·¸ë¦¬ê³  êµ¬ë¶„ ì»¬ëŸ¼(DTYPE)ìœ¼ë¡œ ì–´ë–¤ ìì‹ ë°ì´í„°ê°€ ì €ì¥ë˜ì—ˆëŠ”ì§€ êµ¬ë¶„í•œë‹¤. ì¡°íšŒí•  ë•Œ ì¡°ì¸ì„ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì¼ë°˜ì ìœ¼ë¡œ ê°€ì¥ ë¹ ë¥´ë‹¤.

**ğŸš¨ ì£¼ì˜í•  ì **
ìì‹ ì—”í‹°í‹°ê°€ ë§¤í•‘í•œ ì»¬ëŸ¼ì€ ëª¨ë‘ nullì„ í—ˆìš©í•´ì•¼ í•œë‹¤.

```java
@Entity
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(name = "DTYPE") 
public abstract class Item {

	@Id @GeneratedValue
	@Column(name = "ITEM_ID")
	private Long id;

	private String name; //ì´ë¦„
	private int price; //ê°€ê²©
	...
}

@Entity
@DiscriminatorValue("A") 
public class Album extends Item {
	...
}

@Entity
@DiscriminatorValue("M") 
public class Movie extends Item {
	...
}
```

ğŸ”» ì¥ì 
- ì¡°ì¸ì´ í•„ìš” ì—†ìœ¼ë¯€ë¡œ ì¼ë°˜ì ìœ¼ë¡œ ì¡°íšŒ ì„±ëŠ¥ì´ ë¹ ë¥´ë‹¤
- ì¡°íšŒ ì¿¼ë¦¬ê°€ ë‹¨ìˆœí•˜ë‹¤

ğŸ”» ë‹¨ì 
- ìì‹ ì—”í‹°í‹°ê°€ ë§¤í•‘í•œ ì»¬ëŸ¼ì€ ëª¨ë‘ nullì„ í—ˆìš©í•´ì•¼ í•œë‹¤.
- ë‹¨ì¼ í…Œì´ë¸”ì— ëª¨ë“  ê²ƒì„ ì €ì¥í•˜ë¯€ë¡œ í…Œì´ë¸”ì´ ì»¤ì§ˆ ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ ì„±ëŠ¥ì´ ë” ëŠë ¤ì§ˆ ìˆ˜ ìˆìŒ.

ğŸ”» íŠ¹ì§•
- êµ¬ë¶„ ì»¬ëŸ¼ì„ ê¼­ ì‚¬ìš©í•´ì•¼ í•œë‹¤. 
- ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ìœ¼ë¡œ ì—”í‹°í‹° ì´ë¦„ì„ ì‚¬ìš©í•œë‹¤.

#### êµ¬í˜„ í´ë˜ìŠ¤ë§ˆë‹¤ í…Œì´ë¸” ì „ëµ
êµ¬í˜„ í´ë˜ìŠ¤ë§ˆë‹¤ í…Œì´ë¸” ì „ëµì€ ìì‹ ì—”í‹°í‹°ë§ˆë‹¤ í…Œì´ë¸”ì„ ë§Œë“ ë‹¤. ê·¸ë¦¬ê³  ìì‹ í…Œì´ë¸” ê°ê°ì— í•„ìš”í•œ ì»¬ëŸ¼ì´ ëª¨ë‘ ìˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì¶”ì²œí•˜ì§€ ì•ŠëŠ” ì „ëµì´ë‹¤.
```java
@Entity
@Inheritance(strategy = InheritanceType.TABLE_PER_CLASS)
public abstract class Item {

	@Id @GeneratedValue
	@Column(name = "ITEM_ID")
	private Long id;

	private String name; //ì´ë¦„
	private int price; //ê°€ê²©
	...
}
```

ğŸ”» ì¥ì 
- ì„œë¸Œ íƒ€ì…ì„ êµ¬ë¶„í•´ì„œ ì²˜ë¦¬í•  ë•Œ íš¨ê³¼ì ì´ë‹¤.
- not null ì œì•½ì¡°ê±´ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

ğŸ”» ë‹¨ì 
- ì—¬ëŸ¬ ìì‹ í…Œì´ë¸”ì„ í•¨ê»˜ ì¡°íšŒí•  ë•Œ ì„±ëŠ¥ì´ ëŠë¦¬ë‹¤. (SQLì— UNIONì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤)
- ìì‹ í…Œì´ë¸”ì„ í†µí•©í•´ì„œ ì¿¼ë¦¬í•˜ê¸° ì–´ë µë‹¤

ğŸ”» íŠ¹ì§•
- êµ¬ë¶„ ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.


### @MappedSuperclass
ë¶€ëª¨ í´ë˜ìŠ¤ëŠ” í…Œì´ë¸”ê³¼ ë§¤í•‘í•˜ì§€ ì•Šê³  ë¶€ëª¨ í´ë˜ìŠ¤ë¥¼ ìƒì† ë°›ëŠ” ìì‹ í´ë˜ìŠ¤ì—ê²Œ ë§¤í•‘ ì •ë³´ë§Œ ì œê³µí•˜ê³  ì‹¶ìœ¼ë©´ @MappedSuperclassë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤. @MappedSuperclassëŠ” ì‹¤ì œ í…Œì´ë¸”ê³¼ëŠ” ë§¤í•‘ë˜ì§€ ì•ŠëŠ”ë‹¤. ì´ê²ƒì€ ë‹¨ìˆœíˆ ë§¤í•‘ ì •ë³´ë¥¼ ìƒì†í•  ëª©ì ìœ¼ë¡œë§Œ ì‚¬ìš©ëœë‹¤.

```java
@MappedSuperclass
public abstract class BaseEntity {
  @Id @GeneratedValue
  private Long id;
  private String name;
  ...
}

@Entity
public class Member extends BaseEntity {

  //ID ìƒì†
  //NAME ìƒì†

  private String email;
  ...
}

@Entity
public class Seller extends BaseEntity {

  //ID ìƒì†
  //NAME ìƒì†

  private String shopName;
  ...
}
```

ë¶€ëª¨ë¡œë¶€í„° ë¬¼ë ¤ë°›ì€ ë§¤í•‘ ì •ë³´ë¥¼ ì¬ì •ì˜í•˜ë ¤ë©´ @AttributeOverridesë‚˜ @AttributeOverrideë¥¼ ì‚¬ìš©í•˜ê³ , ì—°ê´€ê´€ê³„ë¥¼ ì¬ì •ì˜í•˜ë ¤ë©´ @AssociationOverridesë‚˜ @AssociationOverrideë¥¼ ì‚¬ìš©í•œë‹¤.

ğŸ”» íŠ¹ì§•
- í…Œì´ë¸”ê³¼ ë§¤í•‘ ë˜ì§€ ì•Šê³  ìì‹ í´ë˜ìŠ¤ì— ì—”í‹°í‹°ì˜ ë§¤í•‘ ì •ë³´ë¥¼ ìƒì†í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•œë‹¤.
- @MappedSuperclassë¡œ ì§€ì •í•œ í´ë˜ìŠ¤ëŠ” ì—”í‹°í‹°ê°€ ì•„ë‹ˆë¯€ë¡œ em.find()ë‚˜ JPQLì—ì„œ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.
- ì´ í´ë˜ìŠ¤ë¥¼ ì§ì ‘ ìƒì„±í•´ì„œ ì‚¬ìš©í•  ì¼ì€ ê±°ì˜ ì—†ìœ¼ë¯€ë¡œ ì¶”ìƒ í´ë˜ìŠ¤ë¡œ ë§Œë“œëŠ” ê²ƒì„ ê¶Œì¥í•œë‹¤.

### ë³µí•© í‚¤ì™€ ì‹ë³„ ê´€ê³„ ë§¤í•‘
#### ì‹ë³„ ê´€ê³„
ì‹ë³„ ê´€ê³„ëŠ” ë¶€ëª¨ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ë¥¼ ë‚´ë ¤ë°›ì•„ì„œ ìì‹ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ + ì™¸ë˜ í‚¤ë¡œ ì‚¬ìš©í•˜ëŠ” ê´€ê³„ë‹¤.

#### ë¹„ì‹ë³„ ê´€ê³„
ë¹„ì‹ë³„ ê´€ê³„ëŠ” ë¶€ëª¨ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ë¥¼ ë°›ì•„ì„œ ìì‹ í…Œì´ë¸”ì˜ ì™¸ë˜ í‚¤ë¡œë§Œ ì‚¬ìš©í•˜ëŠ” ê´€ê³„ë‹¤.

- í•„ìˆ˜ì  ë¹„ì‹ë³„ ê´€ê³„(Mandatory): ì™¸ë˜ í‚¤ì— NULLì„ í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.
- ì„ íƒì  ë¹„ì‹ë³„ ê´€ê³„(Optional): ì™¸ë˜ í‚¤ì— NULLì„ í—ˆìš©í•œë‹¤. (ëŒ€ë¶€ë¶„ì€ ë¹„ì‹ë³„ ê´€ê³„ë¡œ ìœ ì§€í•œë‹¤)

#### ë³µí•© í‚¤
JPAëŠ” ë³µí•© í‚¤ë¥¼ ì§€ì›í•˜ê¸° ìœ„í•´ @IdClassì™€ @EmbeddedId 2ê°€ì§€ ë°©ë²•ì„ ì œê³µí•˜ëŠ”ë° @IdClassëŠ” ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ì— ê°€ê¹Œìš´ ë°©ë²•ì´ê³  @EmbeddedIdëŠ” ì¢€ ë” ê°ì²´ì§€í–¥ì— ê°€ê¹Œìš´ ë°©ë²•ì´ë‹¤.

**@IdClass**
ë³µí•© í‚¤ í…Œì´ë¸”ì€ ë¹„ì‹ë³„ ê´€ê³„ê³  PARENTëŠ” ë³µí•© ê¸°ë³¸ í‚¤ë¥¼ ì‚¬ìš©í•œë‹¤. ì—¬ê¸°ì„œ ë§í•˜ëŠ” ë¶€ëª¨ì™€ ìì‹ì€ ê°ì²´ì˜ ìƒì†ê³¼ëŠ” ë¬´ê´€í•˜ë‹¤.
```java
@Entity
@IdClass(ParentId.class)
public class Parent {
  @Id
  @Column(name = "PARENT_ID1")
  private String id1; //Parentld.id1ê³¼ì—°ê²°

  @Id
  @Column(name = "PARENT_ID2")
  private String id2; //Parentld.id2ì™€ì—°ê²°
  
  private String name;
  ...
}
public class ParentId implements Serializable {
  private String id1; //Parent.id1 ë§¤í•‘
  private String id2; //Parent.id2 ë§¤í•‘

  public ParentId() { }

  public ParentId(String id1, String id2) {
    this.id1 = id1;
    this.id2 = id2;
  }

  @Override
  public boolean equals(Object o) {...}
  @Override
  public int hashCode() {. ..}
}
```
ì—¬ê¸°ì„œ ìì‹ í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•´ë³´ì
```java
@Entity
public class Child {
  @Id
  private String id;

  @ManyToOne
  @JoinColumns({
    @JoinColumn(name = â€PARENT_ID1â€,
      referencedColumnName = "PARENT_ID1"),
    @JoinColumn(name = "PARENT_ID2",
      referencedColumnName = "PARENT_ID2")
  })
  private Parent parent;
  
  ...
}
```

- ì‹ë³„ì í´ë˜ìŠ¤ì˜ ì†ì„±ëª…ê³¼ ì—”í‹°í‹°ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì‹ë³„ìì˜ ì†ì„±ëª…ì´ ê°™ì•„ì•¼ í•œë‹¤. 
(Parent.id1 â†’ ParentId.id1, Parent.id2 â†’ parentId.id2)
- Serializable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•´ì•¼ í•œë‹¤.
- equals, hashCodeë¥¼ êµ¬í˜„í•´ì•¼ í•œë‹¤
- ê¸°ë³¸ ìƒì„±ìê°€ ìˆì–´ì•¼ í•œë‹¤
- ì‹ë³„ì í´ë˜ìŠ¤ëŠ” publicì´ì–´ì•¼ í•œë‹¤

**@EmbeddedId**
@IdClassê°€ ë°ì´í„°ë² ì´ìŠ¤ì— ë§ì¶˜ ë°©ë²•ì´ë¼ë©´ @EmbeddedIdëŠ” ì¢€ ë” ê°ì²´ì§€í–¥ì ì¸ ë°©ë²•ì´ë‹¤.
```java
@Entity
public class Parent {
  @EmbeddedId
  private ParentId id;
  private String name;
  ...
}
```

- @Embeddable ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ì£¼ì–´ì•¼ í•œë‹¤.
- Serializable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•´ì•¼ í•œë‹¤.
- equals, hashCodeë¥¼ êµ¬í˜„í•´ì•¼ í•œë‹¤.
- ê¸°ë³¸ ìƒì„±ìê°€ ìˆì–´ì•¼ í•œë‹¤.
- ì‹ë³„ì í´ë˜ìŠ¤ëŠ” publicì´ì–´ì•¼ í•œë‹¤.

**ë³µí•© í‚¤ì™€ equals(), hashCode()**
ë³µí•© í‚¤ëŠ” quals()ì™€ hashCode()ë¥¼ í•„ìˆ˜ë¡œ êµ¬í˜„í•´ì•¼ í•œë‹¤.
```java
ParentId id1 = new parentId() ;
id1.setld1("myId1â€);
id1.setld2("myId2â€);

ParentId id2 = new parentId();
id2.setId1("myId1");
id2.setId2("myId2");

id1.equals(id2) -> ?
```

equals()ë¥¼ ì ì ˆíˆ ì˜¤ë²„ë¼ì´ë”© í–ˆë‹¤ë©´ ì°¸ì´ê² ì§€ë§Œ equals()ë¥¼ ì ì ˆíˆ ì˜¤ë²„ë¼ì´ë”© í•˜ì§€ ì•Šì•˜ë‹¤ë©´ ê²°ê³¼ëŠ” ê±°ì§“ì´ë‹¤. ìë°”ì˜ ëª¨ë“  í´ë˜ìŠ¤ëŠ” ê¸°ë³¸ equals()ëŠ” ì¸ìŠ¤í„´ìŠ¤ ì°¸ì¡° ê°’ ë¹„êµì¸ == ë¹„êµ(ë™ì¼ì„± ë¹„êµ)ë¥¼ í•˜ê¸° ë•Œë¬¸ì´ë‹¤. ë”°ë¼ì„œ ê°ì²´ì˜ ë™ë“±ì„±(equals ë¹„êµ)ì´ ì§€ì¼œì§€ì§€ ì•Šìœ¼ë©´ ì˜ˆìƒê³¼ ë‹¤ë¥¸ ì—”í‹°í‹°ê°€ ì¡°íšŒë˜ê±°ë‚˜ ì—”í‹°í‹°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ëŠ” ë“± ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ê°€ ì—”í‹°í‹°ë¥¼ ê´€ë¦¬í•˜ëŠ” ë° ì‹¬ê°í•œ ë¬¸ì œê°€ ë°œìƒí•œë‹¤.

**@IdClass vs @EmbeddedId**
@EmbeddedIdê°€ @IdClassì™€ ë¹„êµí•´ì„œ ë” ê°ì²´ì§€í–¥ì ì´ê³  ì¤‘ë³µë„ ì—†ì–´ì„œ ì¢‹ì•„ ë³´ì´ê¸´ í•˜ì§€ë§Œ íŠ¹ì • ìƒí™©ì— JPQLì´ ì¡°ê¸ˆ ë” ê¸¸ì–´ì§ˆ ìˆ˜ ìˆë‹¤.

#### ë³µí•© í‚¤: ì‹ë³„ ê´€ê³„ ë§¤í•‘
ì‹ë³„ ê´€ê³„ì—ì„œ ìì‹ í…Œì´ë¸”ì€ ë¶€ëª¨ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ë¥¼ í¬í•¨í•´ì„œ ë³µí•© í‚¤ë¥¼ êµ¬ì„±í•´ì•¼ í•˜ë¯€ë¡œ @IdClassë‚˜ @EmbeddedIdë¥¼ ì‚¬ìš©í•´ì„œ ì‹ë³„ìë¥¼ ë§¤í•‘í•´ì•¼ í•œë‹¤.

**@IdClassì™€ ì‹ë³„ ê´€ê³„**
```java
//ë¶€ëª¨
@Entity
public class Parent {
  @Id @Column(name = "PARENT_ID")
  private String id;
  private String name;
  ...
}

//ìì‹
@Entity
@IdClass(ChildId.class)
public class Child {
  @Id
  @ManyToOne
  @JoinColumn(name = "PARENT_ID")
  public Parent parent;

  @Id @Column(name = "CHILD_ID")
  private String childId;

  private String name;
}

//ìì‹ ID
public class ChildId implements Serializable {
  private String parent; //Child.parent ë§¤í•‘
  private String childId; //Child.childId ë§¤í•‘
  //equals, hashCode
}

//ì†ì
@Entity
@IdClass(GrandChildld.class)
public class GrandChild {
  @Id
  @ManyToOne
  @JoinColumns({
    @JoinColunm(name = "PARENT_ID"),
    @JoinColumn(name = "CHILD_ID")
  })
  private Child child;

  @Id @Column(name = "GRANDCHILD_ID")
  private String id;
  private String name;
  ...
}

//ì†ì ID
public class GrandChildld implements Serializable {
  private ChildId child; //GrandChild.child ë§¤í•‘
  private String id; //GrandChild.id ë§¤í•‘

  //equals, hashCode
	...
}
```

**@EmbeddedIdì™€ ì‹ë³„ ê´€ê³„**
@EmbeddedIdë¡œ ì‹ë³„ ê´€ê³„ë¥¼ êµ¬ì„±í•  ë•ŒëŠ” @MapsIdë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.

```java
//ë¶€ëª¨
@Entity
public class Parent {
  @Id @Column(name = "PARENT_ID")
  private String id;

  private String name;
}

//ìì‹
@Entity
public class Child {
  @EmbeddedId
  private ChildId id;

  @MapsId("parentId") //ChildId.parentId ë§¤í•‘
  @ManyToOne
  @JoinColumn(name = "PARENT_ID")
  public Parent parent;

  private String name;
}

//ìì‹ ID
@Embeddable
public class ChildId implements Serializable {
  private String parentId; //@MapsId("parentId")ë¡œë§¤í•‘
  
  @Column(name = "CHILD_ID")
  private String id;

  //equals, hashCode
  ...
}

//ì†ì
@Entity
public class GrandChild {
  @EmbeddedId
  private GrandChildId id;

  @MapsId("childId") //GrandChildId.childId ë§¤í•‘
  @ManyToOne
  @JoinColumns({
    @JoinColumn(name = "PARENT_ID"),
    @JoinColumn(name = "CHILD_ID")
  })
  private Child child;

  private String name;
	...
}

//ì†ì ID
@Embeddable
public class GrandChildld implements Serializable {
  private Childld childld; //@MapsId(â€childld")ë¡œ ë§¤í•‘
  @Column(name = "GRANDCHILD_ID")
  private String id;

  //equals, hashCode
  ... 
}
```

#### ë¹„ì‹ë³„ ê´€ê³„ë¡œ êµ¬í˜„
ë¹„ì‹ë³„ ê´€ê³„ë¡œ ë§Œë“  í…Œì´ë¸”ì„ ë§¤í•‘í•´ë³´ì
```java
//ë¶€ëª¨
@Entity
public class Parent {
  @Id @GeneratedValue
  @Column(name = "PARENT_ID")
  private Long id;
  private String name;
  ...
}

//ìì‹
@Entity
public class Child {
  @Id @GeneratedValue
  @Column(name = "CHILD_ID")
  private Long id;
  private String name;

  @ManyToOne
  @JoinColumn(name = "PARENT_ID")
  private Parent parent;
  
  ...
}

//ì†ì
@Entity
public class Grandchild {
  @Id @GeneratedValue
  @Column(name = "GRANDCHILD_ID")
  private Long id;
  private String name;

  @ManyToOne
  @JoinColumn(name = "CHILD_ID")
  private Child child;

  ...
}
```
ì‹ë³„ ê´€ê³„ì˜ ë³µí•© í‚¤ë¥¼ ì‚¬ìš©í•œ ì½”ë“œì™€ ë¹„êµí•˜ë©´ ë§¤í•‘ë„ ì‰½ê³  ì½”ë“œë„ ë‹¨ìˆœí•˜ë‹¤. ê·¸ë¦¬ê³  ë³µí•© í‚¤ë¥¼ ì—†ìœ¼ë¯€ë¡œ ë³µí•© í‚¤ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì§€ ì•Šì•„ë„ ëœë‹¤.


#### ì¼ëŒ€ì¼ ì‹ë³„ ê´€ê³„
ì¼ëŒ€ì¼ ì‹ë³„ ê´€ê³„ëŠ” ìì‹ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ ê°’ìœ¼ë¡œ ë¶€ëª¨ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ ê°’ë§Œ ì‚¬ìš©í•œë‹¤.

```java
//ë¶€ëª¨
@Entity
public class Board {
  @Id @GeneratedValue
  @Column(name = "BOARD_ID")
  private Long id;
  private String titie;

  @OneToOne(mappedBy = "board")
  private BoardDetail boardDetail;
  ...
}

//ìì‹
@Entity
public class BoardDetail {
  @Id
  private Long boardId;
  @MapsId //BoardDetail.boardId ë§¤í•‘
  @OneToOne
  @JoinColumn(name="BOARD_ID")
  private Board board;
  private String content;
  ...
}
```

#### ì‹ë³„, ë¹„ì‹ë³„ ê´€ê³„ì˜ ì¥ë‹¨ì 
ğŸ”» ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ ê´€ì ì—ì„œ ë¹„ì‹ë³„ ê´€ê³„ë¥¼ ì„ í˜¸í•˜ëŠ” ì´ìœ 
- ì‹ë³„ ê´€ê³„ëŠ” ë¶€ëª¨ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ë¥¼ ìì‹ í…Œì´ë¸”ë¡œ ì „íŒŒí•˜ë©´ì„œ ìì‹ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ ì»¬ëŸ¼ì´ ì ì  ëŠ˜ì–´ë‚œë‹¤. ê²°êµ­ ì¡°ì¸í•  ë•Œ SQLì´ ë³µì¡í•´ì§€ê³  ê¸°ë³¸ í‚¤ ì¸ë±ìŠ¤ê°€ ë¶ˆí•„ìš”í•˜ê²Œ ì»¤ì§ˆ ìˆ˜ ìˆë‹¤.
- ì‹ë³„ ê´€ê³„ëŠ” 2ê°œ ì´ìƒì˜ ì»¬ëŸ¼ì„ í•©í•´ì„œ ë³µí•© ê¸°ë³¸ í‚¤ë¥¼ ë§Œë“¤ì–´ì•¼í•˜ëŠ” ê²½ìš°ê°€ ë§ë‹¤.
- ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ì€ ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ì–¸ì  ê°€ëŠ” ë³€í•œë‹¤. ì‹ë³„ ê´€ê³„ì˜ ìì—° í‚¤ ì»¬ëŸ¼ë“¤ì´ ìì‹ì— ì†ìê¹Œì§€ ì „íŒŒë˜ë©´ ë³€ê²½í•˜ê¸° í˜ë“¤ë‹¤
- ì‹ë³„ ê´€ê³„ëŠ” í…Œì´ë¸” êµ¬ì¡°ê°€ ìœ ì—°í•˜ì§€ ëª»í•˜ë‹¤.

ğŸ”» ê°ì²´ ê´€ê³„ ë§¤í•‘ ê´€ì ì—ì„œ ë¹„ì‹ë³„ ê´€ê³„ë¥¼ ì„ í˜¸í•˜ëŠ” ì´ìœ 
- JPAì—ì„œ ë³µí•© í‚¤ëŠ” ë³„ë„ì˜ ë³µí•© í‚¤ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ì„œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
- JPAëŠ” @GenerateValueì²˜ëŸ¼ ëŒ€ë¦¬ í‚¤ë¥¼ ìƒì„±í•˜ê¸° ìœ„í•œ í¸ë¦¬í•œ ë°©ë²•ì„ ì œê³µí•œë‹¤. ê·¸ëŸ¬ë‚˜ ì‹ë³„ ê´€ê³„ì—ì„œëŠ” ì‚¬ìš©í•˜ê¸° í˜ë“¤ë‹¤.

### ì¡°ì¸ í…Œì´ë¸”
ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì˜ ì—°ê´€ê´€ê³„ë¥¼ ì„¤ê³„ ë°©ë²•ì€ í¬ê²Œ 2ê°€ì§€ê°€ ìˆë‹¤.
- ì¡°ì¸ ì»¬ëŸ¼ ì‚¬ìš©(ì™¸ë˜í‚¤)
- ì¡°ì¸ í…Œì´ë¸” ì‚¬ìš©(í…Œì´ë¸” ì‚¬ìš©)

![](https://velog.velcdn.com/images/chhaewxn/post/91e340cf-7f63-40c8-8b94-960c07f86a0d/image.png)

ğŸ”» ì¡°ì¸ ì»¬ëŸ¼ ì‚¬ìš©
ì„ íƒì  ë¹„ì‹ë³„ ê´€ê³„ëŠ” ì™¸ë˜ í‚¤ì— nullì„ í—ˆìš© í•˜ë¯€ë¡œ íšŒì›ê³¼ ì‚¬ë¬¼í•¨ì„ ì¡°ì¸í•  ë•Œ ì™¸ë¶€ ì¡°ì¸(OUTER JOIN)ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤. ì‹¤ìˆ˜ë¡œ ë‚´ë¶€ ì¡°ì¸ì„ ì‚¬ìš©í•˜ë©´ ì‚¬ë¬¼í•¨ê³¼ ê´€ê³„ê°€ ì—†ëŠ” íšŒì›ì€ ì¡°íšŒë˜ì§€ ì•ŠëŠ”ë‹¤. ê·¸ë¦¬ê³  íšŒì›ê³¼ ì‚¬ë¬¼í•¨ì´ ì•„ì£¼ ê°€ë” ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤ë©´ ì™¸ë˜ í‚¤ ê°’ ëŒ€ë¶€ë¶„ì´ nullë¡œ ì €ì¥ë˜ëŠ” ë‹¨ì ì´ ìˆë‹¤.

ğŸ”» ì¡°ì¸ í…Œì´ë¸” ì‚¬ìš©
ì´ ë°©ë²•ì€ ì¡°ì¸ í…Œì´ë¸”ì´ë¼ëŠ” ë³„ë„ì˜ í…Œì´ë¸”ì„ ì‚¬ìš©í•´ì„œ ì—°ê´€ê´€ê³„ë¥¼ ê´€ë¦¬í•œë‹¤. ë”°ë¼ì„œ MEMBERì™€ LOCKERì—ëŠ” ì—°ê´€ê´€ê³„ë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•œ ì™¸ë˜ í‚¤ ì»¬ëŸ¼ì´ ì—†ë‹¤. ë‹¨ì ì€ ì¡°ì¸ í…Œì´ë¸”ì„ í•˜ë‚˜ ì¶”ê°€í•´ì•¼ í•œë‹¤ëŠ” ì ì´ë‹¤.

#### ì¼ëŒ€ì¼ ì¡°ì¸ í…Œì´ë¸”
ì¼ëŒ€ì¼ ê´€ê³„ë¥¼ ë§Œë“¤ë ¤ë©´ ì¡°ì¸ í…Œì´ë¸”ì˜ ì™¸ë˜ í‚¤ ì»¬ëŸ¼ ê°ê°ì— ì´ 2ê°œì˜ ìœ ë‹ˆí¬ ì œì•½ì¡°ê±´ì„ ê±¸ì–´ì•¼ í•œë‹¤. (PARNET_IDëŠ” ê¸°ë³¸ í‚¤ì´ë¯€ë¡œ ìœ ë‹ˆí¬ ì œì•½ì¡°ê±´ì´ ê±¸ë ¤ ìˆë‹¤)

```java
//ë¶€ëª¨
@Entity
public class Parent {
  @Id @GeneratedValue
  @Column(name = "PARENT_ID")
  private Long id;
  private String name;
  
  @OneToOne
  @JoinTable(name = "PARENT_CHILD",
    joinColumns = @JoinColumn(name = "PARENT_ID"),
    inverseJoinColumns = @JoinColumn(name = "CHILD_ID")
  )
  private Child child;
  ...
}

//ìì‹
@Entity
public class ChiId {
  @Id @GeneratedValue
  @Column(name = "CHILD_ID")
  private Long id;
  private String name;
  ...
}
```

#### ì¼ëŒ€ë‹¤ ì¡°ì¸ í…Œì´ë¸”
ì¼ëŒ€ë‹¤ ê´€ê³„ë¥¼ ë§Œë“¤ë ¤ë©´ ì¡°ì¸ í…Œì´ë¸”ì˜ ì»¬ëŸ¼ ì¤‘ ë‹¤ì™€ ê´€ë ¨ëœ ì»¬ëŸ¼ì¸ CHILD_IDì— ìœ ë‹ˆí¬ ì œì•½ì¡°ê±´ì„ ê±¸ì–´ì•¼ í•œë‹¤.

#### ë‹¤ëŒ€ì¼ ì¡°ì¸ í…Œì´ë¸”
ë‹¤ëŒ€ì¼ì€ ì¼ëŒ€ë‹¤ì—ì„œ ë°©í–¥ë§Œ ë°˜ëŒ€ì´ë‹¤
```java
//ë¶€ëª¨
@Entity
public class Parent {
  @Id @GeneratedValue
  @Column(name = "PARENT_ID")
  private Long id;
  private String name;
  
  @OneToMany(mappedBy = "parent")
  private List<Child> child = new ArrayList<Child>();
}

//ìì‹
@Entity
public class Child {
  @Id @GeneratedValue
  @Column(name = â€CHILD_ID")
  private Long id;
  private String name;
  @ManyToOne(optional = false)
  @JoinTable(name = HPARENT_CHILD",
    joinColumns = @JoinColumn(name = "CHILD_ID"),
    inverseJoinColumns = @JoinColumn(name = "PARENT_ID")
  )
  private Parent parent;
}
```

#### ë‹¤ëŒ€ë‹¤ ì¡°ì¸ í…Œì´ë¸”
ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ ë§Œë“¤ë ¤ë©´ ì¡°ì¸ í…Œì´ë¸”ì˜ ë‘ ì»¬ëŸ¼ì„ í•©í•´ì„œ í•˜ë‚˜ì˜ ë³µí•© ìœ ë‹ˆí¬ ì œì•½ì¡°ê±´ì„ ê±¸ì–´ì•¼ í•œë‹¤.
```java
//ë¶€ëª¨
@Entity
public class Parent {
  @Id @GeneratedValue
  @Column(name = "PARENT_ID")
  private Long id;
  private String name;

  @ManyToMany
  @JoinTable(name = "PARENT_CHILD",
    joinColumns = @JoinColumn(name = "PARENT_ID"ã€‹,
    inverseJoinColumns = @JoinColumn(name = "CHILD_ID")
  )
  private List<Child> child = new ArrayList<Childã€‰();
}

//ìì‹
@Entity
public class Child {
  @Id @GeneratedValue
  @Column(name = "CHILD_ID")
  private Long id;
  private String name;
}
```
ì¡°ì¸ í…Œì´ë¸”ì— ì»¬ëŸ¼ì„ ì¶”ê°€í•˜ë©´ @JoinTable ì „ëµì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤. ëŒ€ì‹ ì— ìƒˆë¡œìš´ ì—”í‹°í‹°ë¥¼ ë§Œë“¤ì–´ì„œ ì¡°ì¸ í…Œì´ë¸”ê³¼ ë§¤í•‘í•´ì•¼ í•œë‹¤.

### ì—”í‹°í‹° í•˜ë‚˜ì— ì—¬ëŸ¬ í…Œì´ë¸” ë§¤í•‘
ì˜ ì‚¬ìš©í•˜ì§€ëŠ” ì•Šì§€ë§Œ @SecondaryTableì„ ì‚¬ìš©í•˜ë©´ í•œ ì—”í‹°í‹°ì— ì—¬ëŸ¬ í…Œì´ë¸”ì„ ë§¤í•‘í•  ìˆ˜ ìˆë‹¤.
![](https://velog.velcdn.com/images/chhaewxn/post/9b6e456f-f381-4c3d-b903-117b04b0c03a/image.png)

```java
@Entity
@Table(name="BOARD")
@SecondaryTable (name = "BOARD_DETAIL" ,
  pkJoinColumns = SPrimaryKeyJoinColumn (name = "BOARD_DETAIL_ID"))
public class Board {
  @Id @GeneratedValue
  @Column(name = "BOARD_ID")
  private Long id;
  private String title;

  @Column(table = "BOARD_DETAIL")
  private String content;
  ...
}
```
@SecondaryTable ì†ì„±ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
- @SecondaryTable.name : ë§¤í•‘í•  ë‹¤ìŒ í…Œì´ë¸” ì´ë¦„
- @SecondaryTable.pkJoinColumns : ë§¤í•‘í•  ë‹¤ë¥¸ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ ì»¬ëŸ¼ ì†ì„±

@SecondaryTableì„ ì‚¬ìš©í•´ì„œ ë‘ í…Œì´ë¸”ì„ í•˜ë‚˜ì˜ ì—”í‹°í‹°ì— ë§¤í•‘í•˜ëŠ” ë°©ë²•ë³´ë‹¤ëŠ” í…Œì´ë¸”ë‹¹ ì—”í‹°í‹°ë¥¼ ê°ê° ë§Œë“¤ì–´ì„œ ì¼ëŒ€ì¼ ë§¤í•‘í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•œë‹¤. ì´ ë°©ë²•ì€ í•­ìƒ ë‘ í…Œì´ë¸”ì„ ì¡°íšŒí•˜ë¯€ë¡œ ìµœì í™”í•˜ê¸° ì–´ë µë‹¤. ë°˜ë©´ ì¼ëŒ€ì¼ ë§¤í•‘ì€ ì›í•˜ëŠ” ë¶€ë¶„ë§Œ ì¡°íšŒí•  ìˆ˜ ìˆê³  í•„ìš”í•˜ë©´ ë‘˜ì„ í•¨ê»˜ ì¡°íšŒí•˜ë©´ ëœë‹¤.
