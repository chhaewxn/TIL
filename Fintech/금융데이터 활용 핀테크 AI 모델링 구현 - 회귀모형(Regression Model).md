## ğŸ“ ê¸ˆìœµë°ì´í„° í™œìš© í•€í…Œí¬ AI ëª¨ë¸ë§ êµ¬í˜„ ì‹¤ìŠµ 4ì¼ì°¨ - íšŒê·€ëª¨í˜•(Regression Model)

### 1-1. ë°ì´í„° ì…ë ¥

```python
import numpy as np
#ë°ì´í„°ë¥¼ ë°°ì—´(array)ë¡œ ì…ë ¥í•˜ê¸° ìœ„í•´ì„œ numpyë¼ëŠ” ì•Œê³ ë¦¬ì¦˜ì„ npë¼ëŠ” ì´ë¦„ìœ¼ë¡œ í•´ì„œ ì…ë ¥í•©ë‹ˆë‹¤.

#ë†ì–´ì˜ ê¸¸ì´ ì…ë ¥
perch_length = np.array([8.4, 13.7, 15.0, 16.2, 17.4, 18.0, 18.7, 19.0, 19.6, 20.0, 21.0,
       21.0, 21.0, 21.3, 22.0, 22.0, 22.0, 22.0, 22.0, 22.5, 22.5, 22.7,
       23.0, 23.5, 24.0, 24.0, 24.6, 25.0, 25.6, 26.5, 27.3, 27.5, 27.5,
       27.5, 28.0, 28.7, 30.0, 32.8, 34.5, 35.0, 36.5, 36.0, 37.0, 37.0,
       39.0, 39.0, 39.0, 40.0, 40.0, 40.0, 40.0, 42.0, 43.0, 43.0, 43.5,
       44.0])

#ì…ë ¥ê°’ í™•ì¸
perch_length

#ë†ì–´ ìˆ«ì í™•ì¸
len(perch_length)

#ë†ì–´ì˜ ë¬´ê²Œ
perch_weight = np.array([5.9, 32.0, 40.0, 51.5, 70.0, 100.0, 78.0, 80.0, 85.0, 85.0, 110.0,
       115.0, 125.0, 130.0, 120.0, 120.0, 130.0, 135.0, 110.0, 130.0,
       150.0, 145.0, 150.0, 170.0, 225.0, 145.0, 188.0, 180.0, 197.0,
       218.0, 300.0, 260.0, 265.0, 250.0, 250.0, 300.0, 320.0, 514.0,
       556.0, 840.0, 685.0, 700.0, 700.0, 690.0, 900.0, 650.0, 820.0,
       850.0, 900.0, 1015.0, 820.0, 1100.0, 1000.0, 1100.0, 1000.0,
       1000.0])

#ì…ë ¥ê°’ í™•ì¸
perch_weight

#ë†ì–´ ìˆ«ì í™•ì¸
len(perch_weight)
#ìˆ«ìê°€ ë§ëŠ”ì§€ í™•ì¸, ì´ 56ê°œê°€ ë¼ì•¼ í•œë‹¤.

```

## 1-2. ë°ì´í„°ë¥¼ í•œ ë²ˆì— ë³´ê¸° : ì‚°ì ë„

```python
import matplotlib.pyplot as plt
#ì°¨íŠ¸ë¥¼ ê·¸ë¦¬ëŠ” í•¨ìˆ˜ë¥¼ pltë¡œ ì´ë¦„ì„ ì¤„ì—¬ì„œ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.

plt.scatter(perch_length, perch_weight)
#ë†ì–´ì˜ ê¸¸ì´ë¥¼ xì¶• ë†ì–´ì˜ ë¬´ê²Œë¥¼ yì¶•ìœ¼ë¡œ í•˜ëŠ” ì°¨íŠ¸ë¥¼ ê·¸ë¦½ë‹ˆë‹¤.
```
![](https://velog.velcdn.com/images/chhaewxn/post/f7b90509-a63d-4cf4-b019-4cffe34b0e94/image.png)


```python
#ê³µë¶„ì‚°
a1=np.cov(perch_length,perch_weight)

a=np.cov(perch_length,perch_weight)[0,1]
#[0,1]ë¥¼ ë¹¼ê³  ì…ë ¥í•˜ë©´ í–‰ë ¬ë¡œ ë‚˜ì˜¨ë‹¤.
print(a)

#ìƒê´€ê³„ìˆ˜
b=np.corrcoef(perch_length,perch_weight)[0,1]
#[0,1]ë¥¼ ë¹¼ê³  ì…ë ¥í•˜ë©´ í–‰ë ¬ë¡œ ë‚˜ì˜¨ë‹¤.
print(b)

plt.scatter(perch_length, perch_weight)
#ë†ì–´ì˜ ê¸¸ì´ë¥¼ xì¶• ë†ì–´ì˜ ë¬´ê²Œë¥¼ yì¶•ìœ¼ë¡œ í•˜ëŠ” ì°¨íŠ¸ë¥¼ ê·¸ë¦½ë‹ˆë‹¤.
plt.xlabel('length')
#ì°¨íŠ¸ì˜ xì¶•ì„ ê¸¸ì´(length)ë¼ê³  ì´ë¦„ì„ ë¶™ì…ë‹ˆë‹¤.
plt.ylabel('weight')
#ì°¨íŠ¸ì˜ yì¶•ì„ ë¬´ê²Œ(weight)ë¼ê³  ì´ë¦„ì„ ë¶™ì…ë‹ˆë‹¤.

plt.scatter(perch_weight, perch_length)
#ë†ì–´ì˜ ê¸¸ì´ë¥¼ yì¶• ë†ì–´ì˜ ë¬´ê²Œë¥¼ xì¶•ìœ¼ë¡œ í•˜ëŠ” ì°¨íŠ¸ë¥¼ ê·¸ë¦½ë‹ˆë‹¤.

import numpy as np

#ê³µë¶„ì‚°
a=np.cov(perch_length, perch_weight)[0,1]
#[0,1]ë¥¼ ë¹¼ê³  ì…ë ¥í•˜ë©´ í–‰ë ¬ë¡œ ë‚˜ì˜¨ë‹¤.
print(a)

#ìƒê´€ê³„ìˆ˜
b=np.corrcoef(perch_length, perch_weight)[0,1]
#[0,1]ë¥¼ ë¹¼ê³  ì…ë ¥í•˜ë©´ í–‰ë ¬ë¡œ ë‚˜ì˜¨ë‹¤.
print(b)
```

**â• ê³µë¶„ì‚°**
: ê³µë¶„ì‚°ì€ ë‘ ë³€ìˆ˜ ê°„ì˜ ê´€ê³„ë¥¼ ë‚˜íƒ€ë‚´ëŠ” í†µê³„ì  ê°œë…ìœ¼ë¡œ, ë‘ ë³€ìˆ˜ê°€ í•¨ê»˜ ì–´ë–»ê²Œ ë³€í•˜ëŠ”ì§€ë¥¼ ì¸¡ì •í•˜ëŠ”ë° ì‚¬ìš©ë¨. ê³µë¶„ì‚°ì˜ ê°’ì´ ì–‘ìˆ˜ë¼ë©´ ë‘ ë³€ìˆ˜ëŠ” ê°™ì€ ë°©í–¥ìœ¼ë¡œ í•¨ê»˜ ì›€ì§ì´ëŠ” ê²½í–¥ì´ ìˆìœ¼ë©°, ìŒìˆ˜ë¼ë©´ ë°˜ëŒ€ ë°©í–¥ìœ¼ë¡œ ì›€ì§ì´ëŠ” ê²½í–¥ì´ ìˆë‹¤. ê³µë¶„ì‚°ì˜ ì ˆëŒ“ê°’ì´ í´ìˆ˜ë¡ ë‘ ë³€ìˆ˜ ê°„ì˜ ê´€ê³„ê°€ ê°•í•˜ê²Œ ë‚˜íƒ€ë‚œë‹¤.

**â• ìƒê´€ê³„ìˆ˜**
: ìƒê´€ê³„ìˆ˜ëŠ” ë‘ ë³€ìˆ˜ ê°„ì˜ ê´€ê³„ë¥¼ -1ë¶€í„° 1 ì‚¬ì´ì˜ ê°’ìœ¼ë¡œ ë‚˜íƒ€ë‚´ëŠ” í†µê³„ì  ì§€í‘œë¡œ, ì£¼ë¡œ í”¼ì–´ìŠ¨ ìƒê´€ê³„ìˆ˜(Pearson Correlation Coefficient)ê°€ ë§ì´ ì‚¬ìš©ëœë‹¤. ìƒê´€ê³„ìˆ˜ëŠ” ê³µë¶„ì‚°ì„ ê° ë³€ìˆ˜ì˜ í‘œì¤€í¸ì°¨ë¡œ ë‚˜ëˆ„ì–´ ì •ê·œí™”í•œ ê°’ì´ë‹¤.

- ìƒê´€ê³„ìˆ˜ê°€ 1ì— ê°€ê¹Œìš°ë©´, ë‘ ë³€ìˆ˜ëŠ” ì–‘ì˜ ì„ í˜• ê´€ê³„ë¥¼ ê°€ì§€ê³  ìˆë‹¤
í•œ ë³€ìˆ˜ê°€ ì¦ê°€í•˜ë©´ ë‹¤ë¥¸ ë³€ìˆ˜ë„ ì¦ê°€
- ìƒê´€ê³„ìˆ˜ê°€ -1ì— ê°€ê¹Œìš°ë©´, ë‘ ë³€ìˆ˜ëŠ” ìŒì˜ ì„ í˜• ê´€ê³„ë¥¼ ê°€ì§€ê³  ìˆë‹¤
í•œ ë³€ìˆ˜ê°€ ì¦ê°€í•˜ë©´ ë‹¤ë¥¸ ë³€ìˆ˜ëŠ” ê°ì†Œ
- ìƒê´€ê³„ìˆ˜ê°€ 0ì— ê°€ê¹Œìš°ë©´, ë‘ ë³€ìˆ˜ ê°„ì—ëŠ” ì„ í˜•ì ì¸ ê´€ê³„ê°€ ê±°ì˜ ì—†ë‹¤

ìƒê´€ê³„ìˆ˜ëŠ” ê³µë¶„ì‚°ê³¼ ë‹¬ë¦¬ ë‹¨ìœ„ì— ì˜í–¥ì„ ë°›ì§€ ì•Šì•„ì„œ ë³€ìˆ˜ë“¤ì˜ ê´€ê³„ë¥¼ íŒŒì•…í•˜ê¸° ë” í¸ë¦¬í•˜ì§€ë§Œ ë‘ ë³€ìˆ˜ ê°„ì˜ ê´€ê³„ê°€ ì„ í˜•ì ì¼ ë•Œì˜ ê´€ê³„ë§Œì„ ì¸¡ì •í•œë‹¤ëŠ” í•œê³„ê°€ ìˆë‹¤!

### 1-3. ë¨¸ì‹ ëŸ¬ë‹ ì½”ë“œ êµ¬í˜„ì„ ìœ„í•œ ë°ì´í„° ì…‹ ë¶„ë¦¬

```python
#ë†ì–´ì˜ ë°ì´í„°ë¥¼ í›ˆë ¨ì„¸íŠ¸/í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¡œ êµ¬ë¶„í•˜ê¸° ìœ„í•´ì„œ ì´ ê¸°ëŠ¥ì´ train_test_splitì„ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.
from sklearn.model_selection import train_test_split

#í›ˆë ¨ì„ ìœ„í•œ ë°ì´í„°, ê²€ì¦(test)ë¥¼ ìœ„í•œ ë°ì´í„°(ê¸¸ì´)ì™€ ë¬´ê²Œ(target)ë¡œ ë°ì´í„°ë¥¼ ë‚˜ëˆ„ê³ , ëœë¤42ì´ë¼ê³  ì§€ì •í•´ ì´ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.
train_input,test_input,train_target,test_target= train_test_split(perch_length, perch_weight, random_state=42)

#1,2,3,4ë¡œ êµ¬ì„±ëœ ì›ì†Œë¥¼ ë°°ì—´(array)í˜•íƒœë¡œ ì§€ì •í•©ë‹ˆë‹¤.
test_array=np.array([1,2,3,4])

#ë°°ì—´(array)í˜•íƒœë¡œ ì–´ë–»ê²Œ ì €ì¥ëëŠ”ì§€ ë³´ê² ìŠµë‹ˆë‹¤.
test_array

#4x1 í–‰ë ¬ê³¼ ê°™ì€ ê²ƒì´êµ°ìš”
print(test_array.shape)

#ë°°ì—´ì„ 2x2ë¡œ ë°”ê¿‰ë‹ˆë‹¤.
test_array1=test_array.reshape(2,2)

#ë°”ê¾¼ ë°°ì—´ì˜ í˜•íƒœë¥¼ ë³´ê¸°
print(test_array1.shape)

#ë°°ì—´ì˜ í¬ê¸°ì— -1ë¥¼ ì…ë ¥í•  ê²½ìš° : ë‚˜ë¨¸ì§€ë¥¼ ì›ì†Œì˜ ê°œìˆ˜ë¡œ ì±„ìš´ë‹¤
train_input1=train_input.reshape(-1,1)
test_input1=test_input.reshape(-1,1)

#ë°”ë€ ë°°ì—´ í˜•ì‹ì„ ì¶œë ¥í•œë‹¤.
print(train_input1.shape, test_input1.shape)

```

### 1-4. ê²°ì •ê³„ìˆ˜

```python
from sklearn.neighbors import KNeighborsRegressor

knr=KNeighborsRegressor()
knr.fit(train_input1, train_target)
knr.score(test_input1, test_target)

print(knr.score(test_input1, test_target))
```

**â• K-Nearest Neighbors(K-NN) ì•Œê³ ë¦¬ì¦˜**
: K-NN íšŒê·€ëŠ” ì£¼ì–´ì§„ ë°ì´í„° í¬ì¸íŠ¸ì— ëŒ€í•´ íšŒê·€ ë¶„ì„ì„ ìˆ˜í–‰í•˜ëŠ”ë° ì‚¬ìš©ë˜ë©°, ì´ì›ƒ ë°ì´í„° í¬ì¸íŠ¸ë“¤ì˜ ê°’ë“¤ì„ í‰ê· ì´ë‚˜ ê°€ì¤‘ í‰ê· ìœ¼ë¡œ ê³„ì‚°í•˜ì—¬ ì˜ˆì¸¡ê°’ ìƒì„±. ì£¼ì–´ë”˜ ë°ì´í„°ì—ì„œ ê°€ì¥ ê°€ê¹Œìš´ ì´ì›ƒ ë°ì´í„° í¬ì¸íŠ¸ë“¤ì„ ê¸°ë°˜ìœ¼ë¡œ ì˜ˆì¸¡ì„ ìˆ˜í–‰í•˜ë¯€ë¡œ, ë°ì´í„°ì˜ íŒ¨í„´ì´ë‚˜ êµ¬ì¡°ë¥¼ í•™ìŠµí•˜ì§€ ì•Šê³  ì£¼ì–´ì§„ ë°ì´í„°ì— ë”°ë¼ ì˜ˆì¸¡ì„ ìˆ˜í–‰í•¨.


### 1-5. ê³¼ëŒ€ ì í•© VS ê³¼ì†Œ ì í•©
```python
#í›ˆë ¨í•œ ëª¨ë¸ì˜ ê²°ì •ê³„ìˆ˜ë¥¼ ë´…ë‹ˆë‹¤.
print(knr.score(train_input1, train_target))

#ê·¼ì ‘ì ì˜ ê°œìˆ˜ë¥¼ 3ê°œë¡œ ì„¤ì •í•©ë‹ˆë‹¤.
#ê·¼ì ‘ì ì„ 3~10ê¹Œì§€ ì˜¬ë ¤ê°€ë©´ì„œ ì •í™•ë„ ê³„ì‚°
knr.n_neighbors=3
#ëª¨ë¸ì„ ê·¼ì ‘ì  3ê°œë¥¼ ë°˜ì˜í•´ ë‹¤ì‹œ í›ˆë ¨ì‹œí‚µë‹ˆë‹¤.
knr.fit(train_input1, train_target)

#ìƒˆë¡­ê²Œ í›ˆë ¨í•œ ê²°ê³¼ì¹˜ì˜ ì ìˆ˜ë¥¼ ë´…ë‹ˆë‹¤.ë°ì´í„°ëŠ” í›ˆë ¨ì„¸íŠ¸
print(knr.score(train_input1, train_target))

print(knr.score(test_input1,test_target))
#í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¡œ í•´ë³´ë‹ˆê¹Œ 97%
```

### 2-1. ì„ í˜• íšŒê·€ ëª¨í˜•

```python

#ì„ í˜•íšŒê·€ ëª¨í˜•ì„ ìœ„í•´ì„œ LinearRegressionì´ë¼ëŠ” í•¨ìˆ˜ë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.
from sklearn.linear_model import LinearRegression

lr = LinearRegression()
# ì„ í˜• íšŒê·€ ëª¨ë¸ í›ˆë ¨
lr.fit(train_input1, train_target)

# 50cm ë†ì–´ì— ëŒ€í•œ ì˜ˆì¸¡
print(lr.predict([[50]]))
#ì• ëª¨ë¸ì˜ ì˜ˆì¸¡ê°’(1033g)ê³¼ ë¹„êµí•´ë´…ë‹ˆë‹¤.

print(lr.coef_, lr.intercept_)
#ì¶•ì˜ ê¸°ìš¸ê¸°ì™€ yì ˆí¸ì„ ë´…ë‹ˆë‹¤.

# í›ˆë ¨ ì„¸íŠ¸ì˜ ì‚°ì ë„ë¥¼ ê·¸ë¦½ë‹ˆë‹¤
plt.scatter(train_input, train_target)
# 15ì—ì„œ 50ê¹Œì§€ 1ì°¨ ë°©ì •ì‹ ê·¸ë˜í”„ë¥¼ ê·¸ë¦½ë‹ˆë‹¤.
# (ì„ í˜•ìœ¼ë¡œ ì„ ì„ ê¸‹ê³  xê°’ì„ ë„£ìœ¼ë©´ yê°’ì„ ì˜ˆì¸¡í•©ë‹ˆë‹¤.)
plt.plot([15, 50], [15*lr.coef_+lr.intercept_, 50*lr.coef_+lr.intercept_])
# 50cm ë†ì–´ ë°ì´í„°
plt.scatter(50, 1241.8, marker='^')
plt.xlabel('length')
plt.ylabel('weight')
plt.show()

print(lr.score(train_input1, train_target))
print(lr.score(test_input1, test_target))
#í›ˆë ¨ìš© ì„¸íŠ¸ë¡œ êµ¬í•œ ì˜ˆì¸¡ë„ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¡œ êµ¬í•œ ì˜ˆì¸¡ë„ë¥¼ ë´…ë‹ˆë‹¤.
```

![](https://velog.velcdn.com/images/chhaewxn/post/513d4b20-90dc-48e5-90ae-5bf95021fdcf/image.png)

### 2-2. ë‹¤í•­íšŒê·€ (ë¹„ì„ í˜• íšŒê·€ ëª¨í˜•)
```python
train_poly = np.column_stack((train_input ** 2, train_input))
test_poly = np.column_stack((test_input ** 2, test_input))
#2ì°¨ ë°©ì •ì‹ìœ¼ë¡œ ì˜ˆì¸¡


print(train_poly.shape, test_poly.shape)

lr = LinearRegression()
lr.fit(train_poly, train_target)

print(lr.predict([[50**2, 50]]))
#ì™œ 50ì˜ ì œê³±ì„ ëª¨í˜•ì— ì§‘ì–´ë„£ì„ê¹Œìš”?

print(lr.coef_, lr.intercept_)
#í›ˆë ¨í•œ ëª¨ë¸ì˜ ê¸°ìš¸ê¸°ì™€ yì ˆí¸ì„ ì¶œë ¥

# êµ¬ê°„ë³„ ì§ì„ ì„ ê·¸ë¦¬ê¸° ìœ„í•´ 15ì—ì„œ 49ê¹Œì§€ ì •ìˆ˜ ë°°ì—´ì„ ë§Œë“­ë‹ˆë‹¤
point = np.arange(15, 50)
# í›ˆë ¨ ì„¸íŠ¸ì˜ ì‚°ì ë„ë¥¼ ê·¸ë¦½ë‹ˆë‹¤
plt.scatter(train_input, train_target)
# 15ì—ì„œ 49ê¹Œì§€ 2ì°¨ ë°©ì •ì‹ ê·¸ë˜í”„ë¥¼ ê·¸ë¦½ë‹ˆë‹¤
plt.plot(point, 1.01*point**2 - 21.6*point + 116.05)
# 50cm ë†ì–´ ë°ì´í„°
plt.scatter([50], [1574], marker='^')
plt.xlabel('length')
plt.ylabel('weight')
plt.show()

```

![](https://velog.velcdn.com/images/chhaewxn/post/6b5c7ee2-6761-4e92-88e5-d9e6f24a3120/image.png)

